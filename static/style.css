/* fileName: style.css */
/* ===== Theme Variables ===== */
:root {
    /* Midnight Pulse (default) */
    --bg: #0a0a0a;
    --bg-overlay: rgba(0,0,0,0.6);
    
    --surface: rgba(255,255,255,0.06);
    --surface-strong: rgba(255,255,255,0.08);
    --surface-hover: rgba(255,255,255,0.12);
    
    --border: rgba(255,255,255,0.12);
    --border-soft: rgba(255,255,255,0.08);
    
    --text: #f5f5f5;
    --text-strong: #ffffff;
    --muted: rgba(255,255,255,0.7);
    
    --accent: #1a73e8;
    --accent-soft: rgba(26,115,232,0.5);
    
    --danger: #ff4d4d;
    --danger-soft: rgba(255,80,80,0.12);
    
    --like: rgba(255,60,60,0.12);
    --like-border: rgba(255,60,60,0.45);
}

/* ===== Polar Breeze ===== */
body.theme-polar {
    --bg: #0d1621;
    --bg-overlay: rgba(10, 20, 35, 0.85);
    
    --surface: rgba(42, 127, 255, 0.08);
    --surface-strong: rgba(42, 127, 255, 0.12);
    --surface-hover: rgba(42, 127, 255, 0.18);
    
    --border: rgba(42, 127, 255, 0.25);
    --border-soft: rgba(42, 127, 255, 0.15);
    
    --text: #dbe9f6;
    --text-strong: #ffffff;
    --muted: rgba(219, 233, 246, 0.6);
    
    --accent: #4da3ff;
    --accent-soft: rgba(77, 163, 255, 0.5);
    
    --danger: #ff6b6b;
    --danger-soft: rgba(255, 107, 107, 0.14);
    
    --like: rgba(255, 107, 107, 0.18);
    --like-border: rgba(255, 107, 107, 0.5);
}

/* ===== Pumpkin Spice ===== */
body.theme-pumpkin {
    --bg: #1a120b;
    --bg-overlay: rgba(20, 15, 10, 0.85);
    
    --surface: rgba(255, 140, 0, 0.08);
    --surface-strong: rgba(255, 140, 0, 0.12);
    --surface-hover: rgba(255, 140, 0, 0.18);
    
    --border: rgba(255, 140, 0, 0.25);
    --border-soft: rgba(255, 140, 0, 0.15);
    
    --text: #fce9d5;
    --text-strong: #ffffff;
    --muted: rgba(252, 233, 213, 0.6);
    
    --accent: #ff9d2e;
    --accent-soft: rgba(255, 157, 46, 0.5);
    
    --danger: #ff5e4d;
    --danger-soft: rgba(255, 94, 77, 0.18);
    
    --like: rgba(255, 120, 80, 0.2);
    --like-border: rgba(255, 120, 80, 0.5);
}

/* ===== Spring Bloom ===== */
body.theme-spring {
    --bg: #0c180f;
    --bg-overlay: rgba(10, 20, 12, 0.85);
    
    --surface: rgba(60, 160, 90, 0.1);
    --surface-strong: rgba(60, 160, 90, 0.16);
    --surface-hover: rgba(60, 160, 90, 0.22);
    
    --border: rgba(60, 160, 90, 0.35);
    --border-soft: rgba(60, 160, 90, 0.2);
    
    --text: #e1f5e8;
    --text-strong: #ffffff;
    --muted: rgba(225, 245, 232, 0.6);
    
    --accent: #52c47a;
    --accent-soft: rgba(82, 196, 122, 0.5);
    
    --danger: #ff5e4d;
    --danger-soft: rgba(194, 59, 42, 0.16);
    
    --like: rgba(255, 120, 120, 0.18);
    --like-border: rgba(255, 120, 120, 0.5);
}

/* ===== Base Layout ===== */
body {
    font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
    background: var(--bg);
    color: var(--text);
    max-width: 520px;
    margin: auto;
    padding: 24px;
    transition: background 0.3s ease, color 0.3s ease;
}

/* ===== Cards / Containers ===== */
.post, form {
    background: var(--surface);
    border: 1px solid var(--border);
    backdrop-filter: blur(6px);
    padding: 16px;
    border-radius: 10px;
    margin-top: 18px;
    transition: background 0.3s ease, border-color 0.3s ease;
}

h2 {
    font-weight: 600;
    margin-bottom: 16px;
    color: var(--text-strong);
}

/* ===== Inputs ===== */
textarea, input, #post-content, .poll-box input {
    width: 100%;
    box-sizing: border-box;
}

textarea, input {
    background: var(--surface-strong);
    color: var(--text-strong);
    border: 1px solid var(--border-soft);
    padding: 12px;
    border-radius: 8px;
    margin-bottom: 12px;
    outline: none;
    transition: border-color 0.2s ease, background 0.2s ease;
}

textarea::placeholder, input::placeholder {
    color: var(--muted);
    opacity: 0.7;
}

textarea:focus, input:focus {
    border-color: var(--text-strong);
    background: var(--surface-hover);
}

textarea {
    resize: none;
    overflow: hidden;
    min-height: 80px;
    margin-top: 10px;
}

/* ===== Buttons ===== */
button {
    background: var(--text-strong);
    color: var(--bg); 
    border: none;
    padding: 10px 16px;
    border-radius: 999px; 
    cursor: pointer;
    font-weight: 600;
    transition: transform 0.1s ease, opacity 0.1s ease, background 0.3s ease;
}

button:hover {
    opacity: 0.9;
    transform: translateY(-1px);
}

a {
    display: inline-block;
    padding: 8px 14px;
    border-radius: 999px;
    background: var(--surface-strong);
    color: var(--text-strong);
    text-decoration: none;
    font-size: 0.9em;
    transition: background 0.15s ease;
    margin-top: 12px;
}

a:hover {
    background: var(--surface-hover);
}

/* ===== Post Content ===== */
.post p {
    margin: 10px 0;
    line-height: 1.55;
    color: var(--text);
}

.post-footer {
    display: flex;
    justify-content: space-between;
    align-items: center;
    font-size: 0.85em;
    color: var(--muted);
    margin-top: 10px;
}

.post-actions {
    display: flex;
    align-items: center;
    gap: 6px;
}

.post-time {
    white-space: nowrap;
    font-size: 0.8em;
    color: var(--muted);
    opacity: 0.8;
    margin-top: 10px;
}

.private {
    opacity: 0.6;
    font-style: italic;
    color: var(--muted);
}

.composer {
    padding: 14px;
}

.composer-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 10px;
    margin-bottom: 10px;
}

.composer-header select {
    flex: 1;
    max-width: 140px;
    padding: 8px 12px;
    border-radius: 8px;
    border: 1px solid var(--border-soft);
    background: var(--surface);
    color: var(--text);
}

.post-btn {
    padding: 8px 18px;
    border-radius: 999px;
    font-weight: 600;
}

.format-bar {
    display: flex;
    align-items: center;
    gap: 6px;
    padding: 6px 8px;
    border-radius: 8px;
    background: var(--surface);
    margin-bottom: 8px;
}

.format-bar button {
    padding: 4px 8px;
    border-radius: 6px;
    font-size: 0.85em;
    background: var(--bg);
    color: var(--text);
}

.format-bar button:hover {
    background: var(--surface-hover);
    color: var(--text-strong);
}

.format-bar .divider {
    width: 1px;
    height: 18px;
    background: var(--border);
    margin: 0 4px;
}

#post-content {
    margin-top: 4px;
}

.poll-box {
    margin-top: 10px;
}

.add-option {
    margin-top: 6px;
    font-size: 0.85em;
    background: var(--surface-strong);
    color: var(--text);
}

.add-option:hover {
    background: var(--surface-hover);
}

.post-content {
    white-space: pre-wrap;
    word-break: break-word;
    overflow-wrap: anywhere;
    color: var(--text);
}

.post-content.collapsed {
    display: -webkit-box;
    -webkit-line-clamp: 3;
    -webkit-box-orient: vertical;
    overflow: hidden;
}

.post-content a {
    color: var(--accent);
    background: transparent;
    padding: 0;
    text-decoration: none;
    word-break: break-word;
}

.post-content a:hover {
    background: transparent;
    text-decoration: underline;
}

.poll {
    margin-top: 10px;
}

.poll-question {
    margin-bottom: 12px;
    font-weight: 600;
    color: var(--text-strong);
}

.poll-option {
    position: relative;
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 8px;
    padding: 10px 12px;
    margin-bottom: 8px;
    cursor: pointer;
    overflow: hidden;
    transition: background 0.2s ease;
}

.poll-option:hover {
    background: var(--surface-hover);
}

.poll-bar {
    position: absolute;
    left: 0;
    top: 0;
    height: 100%;
    transition: width 0.3s ease;
    z-index: 0;
}

.poll-bar.my-vote {
    background: var(--accent-soft);
}

.poll-bar.other-vote {
    background: var(--surface-hover);
}

.poll-option:hover .poll-bar.other-vote {
    background: var(--border);
}

.poll-text {
    position: relative;
    z-index: 1;
    font-size: 0.9em;
    color: var(--text);
}

.read-toggle {
    background: none;
    border: none;
    color: var(--muted);
    padding: 0;
    margin-top: 6px;
    cursor: pointer;
    font-size: 0.85em;
}

.read-toggle:hover {
    color: var(--text-strong);
    text-decoration: underline;
    opacity: 1;
}

.action-btn {
    display: inline-flex;
    align-items: center;
    gap: 4px;
    padding: 4px 10px;
    border-radius: 999px;
    border: 1px solid var(--border-soft);
    background: var(--surface);
    color: var(--muted);
    text-decoration: none;
    font-size: 0.85em;
    transition: background 0.2s ease, border-color 0.2s ease, opacity 0.2s ease, color 0.2s ease;
}

.action-btn:hover {
    background: var(--surface-hover);
    border-color: var(--border);
    color: var(--text);
}

.edit-btn {
    color: var(--text);
}

.delete-btn {
    color: var(--danger);
    border-color: var(--danger-soft);
}

.delete-btn:hover {
    background: var(--danger-soft);
    border-color: var(--danger);
}

.form-row {
    display: flex;
    gap: 10px;
    margin-top: 12px;
    align-items: center;
}

select {
    width: 100%;
    padding: 10px 16px;
    border-radius: 10px;
    border: 1px solid var(--border-soft);
    background: var(--surface-strong);
    color: var(--text);
    font-size: 0.9em;
    font-weight: 500;
    appearance: none;
    -webkit-appearance: none;
    -moz-appearance: none;
    cursor: pointer;
    transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
    outline: none;
}

select:hover {
    background: var(--surface-hover);
    border-color: var(--border);
}

select:focus {
    border-color: var(--accent);
    box-shadow: 0 0 0 3px var(--accent-soft);
    background: var(--bg);
}

select option {
    background-color: var(--bg);
    color: var(--text);
    padding: 12px;
}

.form-row button {
    border-radius: 8px;
    flex-shrink: 0;
}

.form-row button:hover {
    opacity: 0.85;
}

.form-link {
    display: inline-block;
    margin-top: 0px;
    padding: 8px 12px;
    border-radius: 8px;
    background: var(--surface-strong);
    color: var(--text);
    text-decoration: none;
    font-size: 0.9em;
    transition: background 0.2s ease;
}

.form-link:hover {
    background: var(--surface-hover);
}

.admin-tag {
    color: var(--danger);
    font-size: 0.7em;
    padding: 2px 2px;
    border-radius: 999px;
    margin-left: 1px;
    vertical-align: middle;
    font-weight: 600;
}

.like-btn.liked {
    background: var(--like);
    border-color: var(--like-border);
    color: var(--danger);
}

.like-btn.liked:hover {
    background: var(--like);
    border-color: var(--danger);
    opacity: 0.9;
}

.like-btn {
    color: var(--muted);
    transition: background 0.2s ease, border-color 0.2s ease, transform 0.15s ease, color 0.2s ease;
}

.like-btn:hover {
    color: var(--text);
}

.like-btn:active {
    transform: scale(0.95);
}

/* ===== Top Bar ===== */
.top-bar {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
}

.brand {
    font-size: 1.4em;
    font-weight: 700;
    letter-spacing: 0.5px;
    color: var(--text-strong);
}

.user-box {
    text-align: right;
    display: flex;
    flex-direction: column;
    gap: 4px;
}

.user-name {
    font-weight: 600;
    font-size: 0.95em;
    color: var(--text);
}

.user-name:hover, .username:hover {
    text-decoration: underline;
}

.user-meta {
    font-size: 0.75em;
    color: var(--muted);
}

.logout-btn {
    align-self: flex-end;
    font-size: 0.75em;
    padding: 6px 12px;
    margin-top: 6px;
    background: var(--surface-strong);
    color: var(--text);
}

.logout-btn:hover {
    background: var(--surface-hover);
}

.text-medium {
    font-size: 1.1em;
}

.text-large {
    font-size: 1.35em;
}

.post-image {
    max-width: 100%;
    border-radius: 10px;
    margin-top: 8px;
    border: 1px solid var(--border-soft);
}

/* ===== Segmented Control ===== */
.segmented-control {
    display: inline-flex;
    border-radius: 999px;
    background: var(--surface-strong);
    padding: 4px;
    gap: 4px;
}

.segmented-control button {
    padding: 6px 14px;
    border-radius: 999px;
    font-size: 0.85em;
    background: transparent;
    color: var(--muted);
    transition: all 0.2s ease;
    font-weight: normal;
}

.segmented-control button:hover {
    background: var(--surface-hover);
    color: var(--text);
}

.segmented-control button.active {
    background: var(--text-strong);
    color: var(--bg);
    font-weight: 600;
}

.blurred #main-content {
    filter: blur(6px);
    pointer-events: none;
}

#profile-actions {
    display: flex;
    gap: 10px;
    margin: 15px 0;
}

#profile-actions button {
    padding: 8px 12px;
    border-radius: 6px;
    cursor: pointer;
}

#profile-actions .danger {
    background: var(--danger);
    opacity: 0.2;
    color: #fff;
    pointer-events: none;
}

.post.readonly {
    cursor: pointer;
    opacity: 0.95;
}

.post.readonly:hover {
    border-color: var(--accent);
}

.post.readonly .poll-option.disabled {
    pointer-events: none;
    opacity: 0.6;
}

.post.highlight {
    outline: 2px solid var(--danger);
    background: var(--danger-soft);
}

.profile-overlay {
    position: fixed;
    inset: 0;
    background: var(--bg-overlay);
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 999;
    backdrop-filter: blur(2px);
}

.profile-overlay.hidden {
    display: none;
}

.profile-card {
    width: 90%;
    max-width: 520px;
    max-height: 85vh;
    overflow-y: auto;
    background: var(--bg);
    border: 1px solid var(--border);
    border-radius: 14px;
    padding: 20px;
    position: relative;
    box-shadow: 0 10px 30px rgba(0,0,0,0.3);
}

.profile-header {
    margin-bottom: 14px;
}

.profile-meta {
    display: flex;
    gap: 12px;
    font-size: 0.85em;
    color: var(--muted);
}

.close-btn {
    position: absolute;
    top: 12px;
    right: 12px;
    background: none;
    color: var(--text);
    border: none;
    font-size: 1.2em;
    cursor: pointer;
    padding: 0;
}

.deleted-user {
    color: var(--muted);
    font-style: italic;
    cursor: default;
}

.deleted-user:hover {
    text-decoration: none;
}

.muted textarea, .muted button {
    pointer-events: none;
    opacity: 0.4;
}

.mute-overlay {
    position: absolute;
    inset: 0;
    background: var(--bg-overlay);
    display:flex;
    justify-content:center;
    align-items:center;
    font-weight:700;
    font-size:1.1em;
    color: var(--text-strong);
    border-radius: 10px;
    z-index: 10;
}

.mute-overlay.hidden {
    display:none;
}

#admin-users > div, #admin-private > div {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 8px 10px;
    gap: 12px;
    border-bottom: 1px solid var(--border);
}

details {
    margin-bottom: 18px;
}

details summary {
    margin-bottom: 10px;
    cursor: pointer;
    font-weight: 600;
    color: var(--text);
}

.post-header {
    display: flex;
    justify-content: space-between;
    font-size: 0.9rem;
    color: var(--muted);
}

/* ===== CUSTOM NOTIFICATIONS & MODALS ===== */
#toast-container {
    position: fixed;
    bottom: 24px;
    left: 50%;
    transform: translateX(-50%);
    z-index: 2000;
    display: flex;
    flex-direction: column;
    gap: 8px;
    pointer-events: none;
}

.toast {
    background: var(--surface-strong);
    border: 1px solid var(--border);
    color: var(--text-strong);
    padding: 10px 24px;
    border-radius: 999px;
    font-size: 0.95em;
    box-shadow: 0 4px 15px rgba(0,0,0,0.3);
    backdrop-filter: blur(12px);
    opacity: 0;
    transform: translateY(20px);
    animation: toastIn 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards;
}

.toast.success { border-color: var(--accent); color: var(--accent); }
.toast.error { border-color: var(--danger); color: var(--danger); }

@keyframes toastIn {
    to { opacity: 1; transform: translateY(0); }
}

@keyframes toastOut {
    to { opacity: 0; transform: translateY(-10px); }
}

.modal-overlay {
    position: fixed;
    inset: 0;
    background: var(--bg-overlay);
    backdrop-filter: blur(4px);
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 2000;
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.2s ease;
}

.modal-overlay.active {
    opacity: 1;
    pointer-events: auto;
}

.modal-box {
    background: var(--bg);
    border: 1px solid var(--border);
    padding: 24px;
    border-radius: 16px;
    width: 90%;
    max-width: 380px;
    box-shadow: 0 20px 50px rgba(0,0,0,0.5);
    display: flex;
    flex-direction: column;
    gap: 16px;
    transform: scale(0.95);
    transition: transform 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275);
}

.modal-overlay.active .modal-box {
    transform: scale(1);
}

.modal-title { font-size: 1.2em; font-weight: 700; color: var(--text-strong); }
.modal-body { font-size: 0.95em; color: var(--text); line-height: 1.5; }

.modal-input {
    width: 100%;
    background: var(--surface);
    border: 1px solid var(--border-soft);
    color: var(--text-strong);
    padding: 12px;
    border-radius: 8px;
    margin-top: 5px;
    box-sizing: border-box;
}

.modal-input:focus { border-color: var(--accent); outline: none; }

.modal-actions {
    display: flex;
    justify-content: flex-end;
    gap: 8px;
    margin-top: 10px;
}

.btn-ghost { background: transparent; color: var(--muted); border: none; font-weight: 600; cursor: pointer; }
.btn-ghost:hover { color: var(--text-strong); }
.btn-primary { background: var(--text-strong); color: var(--bg); padding: 8px 16px; border-radius: 8px; border: none; font-weight: 600; cursor: pointer; }
.btn-danger { background: var(--danger); color: #fff; padding: 8px 16px; border-radius: 8px; border: none; font-weight: 600; cursor: pointer; }

/* ===== MEDIA QUERIES ===== */
@media (max-width: 600px) {
    body { padding: 14px; font-size: 16px; }
    input, textarea, select { font-size: 16px; }
    button { padding: 10px 16px; font-weight: 400; }
    .post p, .post-content { font-size: 1.05rem; line-height: 1.6; }
    .poll-text { font-size: 1rem; }
}

@media (min-width: 992px) {
    #main-content { margin-right: 0 !important; }
    .mobile-footer { display: none !important; }

    .dm-sidebar {
        position: fixed;
        right: 0;
        top: 0;
        width: 72px;
        height: 100vh;
        background: var(--bg);
        border-left: 1px solid var(--border);
        display: flex;
        flex-direction: column;
        z-index: 1000;
        transition: width 0.2s;
        overflow: hidden;
    }

    .dm-sidebar:hover {
        width: 240px;
        box-shadow: -10px 0 30px rgba(0,0,0,0.3);
        align-items: stretch;
    }

    #dm-list {
        flex-grow: 1;
        overflow-y: auto;
        overflow-x: hidden;
        width: 100%;
    }

    .sidebar-footer {
        width: 100%;
        border-top: 1px solid var(--border);
        display: flex;
        justify-content: center;
    }
}

.mobile-footer { display: none; }

@media (max-width: 991px) {
    .dm-sidebar { display: none !important; }
    .hide-on-mobile { display: none !important; }
    
    .mobile-footer {
        position: fixed;
        bottom: 0;
        left: 0;
        width: 100%;
        height: 65px;
        background: var(--bg);
        border-top: 1px solid var(--border);
        display: flex;
        justify-content: space-around;
        align-items: center;
        z-index: 9999;
    }
    #main-content { padding-bottom: 80px; } 
    #toast-container { bottom: 80px; }
}

/* --- Internal Sidebar Elements --- */
.dm-item {
    display: flex;
    align-items: center; 
    padding: 12px 18px;
    text-decoration: none;
    width: 90%;
    transition: background 0.2s;
    background: transparent; 
    margin-top: 0;
    border-radius: 0; 
}

.dm-item:hover { background: var(--surface-hover); }

.dm-icon {
    width: 35px;
    height: 35px;
    background: var(--accent-soft);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: bold;
    flex-shrink: 0;
    transition: border-radius 0.2s, background 0.2s;
}

.dm-item:hover .dm-icon { border-radius: 12px; }

.dm-name {
    margin-left: 15px;
    font-weight: 600;
    white-space: nowrap;
    color: var(--text-strong);
    opacity: 0;
    width: 0;
    display: inline-block;
    overflow: hidden;
    transition: opacity 0.3s ease, width 0.3s ease;
}

.search-trigger {
    background: transparent;
    border: none;
    cursor: pointer;
    width: 100%;
    text-align: left;
    outline: none;
}

.sidebar-footer {
    display: flex;
    flex-direction: column;
}

@media (min-width: 992px) {
    .dm-sidebar:hover .dm-name {
        opacity: 1;
        width: auto;
    }
    .chat-header-bar {
        display: flex;
        justify-content: space-between;
        align-items: center;
        background: var(--bg);
        border-bottom: 1px solid var(--border);
        padding: 10px 20px;
        flex-shrink: 0; /* Prevents the header from squishing */
        z-index: 1000;
    }
    .chat-input-wrap {
        position: static; /* Let flexbox handle the position */
        width: 100%;
        max-width: 800px;
        margin: 0 auto;
    }
}

@media (max-width: 768px) {
    .dm-sidebar { width: 70px; }
    .dm-sidebar:hover { width: 280px; }
    .chat-header-bar {
        display: flex;
        align-items: center;
        justify-content: space-between;
        background: var(--bg);
        position: relative; /* Changed from fixed */
        width: 100%;
        padding: 10px 20px;
        box-shadow: 0 2px 5px rgba(0,0,0,0.5);
        z-index: 1000;
        box-sizing: border-box;
        flex-shrink: 0; /* Prevents header from squishing */
    }
}

.message-btn {
    background: var(--accent);
    color: white;
    padding: 8px 16px;
    border-radius: 8px;
    border: none;
    cursor: pointer;
    font-weight: 600;
    transition: background 0.2s;
}

.message-btn:hover { background: var(--accent-soft); }

.search-box input:focus {
    border-color: var(--accent) !important;
    outline: none;
}

#search-results .dm-item {
    background: var(--surface-strong);
    border-bottom: 1px solid var(--accent-soft);
}

/* ===== FIXED CHAT LAYOUT ===== */
/* This says: If the body has a theme AND contains a .chat-main element, lock the screen */
body:has(.chat-main) {
    max-width: none !important;
    width: 100vw !important;
    height: 100dvh !important;
    margin: 0 !important;
    padding: 0 !important;
    display: flex !important;
    flex-direction: column !important;
    overflow: hidden !important;
}

.icon-btn {
    background: var(--accent-soft);
    color: var(--text-strong);
    border: none;
    padding: 6px 12px;
    border-radius: 8px;
    cursor: pointer;
    font-weight: 600;
    transition: background 0.2s;
    font-size: 0.9em;
}

.icon-btn:hover { background: var(--surface-hover); }

/* Find this in your style.css and update it */
.chat-container {
    display: flex;
    flex: 1;          
    overflow: hidden; 
    background: var(--bg);
    min-height: 0;  /* Changed from height: 0 */
}

.dm-list-container {
    flex: 1;
    overflow-y: auto;
    padding: 20px;
    background: var(--bg);
    width: 100%;
    max-width: 600px;
    margin: 0 auto;
}

.dm-list-container .dm-item {
    border-radius: 10px;
    margin-bottom: 8px;
    background: var(--surface);
    width: 100%;
    box-sizing: border-box;
}

.dm-list-container .dm-item:hover {
    background: var(--surface-hover);
}

/* Replace your existing .chat-main rule */
.chat-main {
    flex: 1;
    display: flex;
    flex-direction: column;
    height: 100%; /* Important: Fills the chat-container */
    width: 100%;
    max-width: 800px;
    margin: 0 auto;
    background: var(--bg);
    overflow: hidden; /* Only the messages-container inside should scroll */
}

.messages-container {
    flex: 1;            /* This pushes the input bar to the bottom */
    overflow-y: auto;   /* This enables scrolling ONLY for the messages */
    padding: 20px;
    display: flex;
    flex-direction: column;
    gap: 10px;
}

/* Update your .msg rule in style.css */
.msg {
    max-width: 70%;
    padding: 10px 14px;
    border-radius: 15px;
    
    /* ADD THESE THREE LINES */
    word-break: break-word;   /* Older browser support */
    overflow-wrap: anywhere; /* Modern browser support, breaks long strings */
    white-space: pre-wrap;    /* Preserves your line breaks and wraps text */
}

.msg.sent { 
    align-self: flex-end; 
    background: var(--accent); 
    color: white; 
    border-bottom-right-radius: 2px; 
}

.msg.received { 
    align-self: flex-start; 
    background: var(--surface-strong); 
    border-bottom-left-radius: 2px; 
}

/* Global update for the input wrap */
.chat-input-wrap {
    position: relative; /* Ensure it is NOT fixed */
    bottom: auto;
    width: 100%;
    flex-shrink: 0;     /* Keeps the input area from getting squashed */
    padding: 15px 20px;
    background: var(--surface);
    display: flex;
    gap: 10px;
    border-top: 1px solid var(--border);
    box-sizing: border-box;
}

/* Mobile footer fix: hide it when in a specific chat to save space */
body:has(.chat-main) .mobile-footer {
    display: none !important; /* Hide footer when INSIDE a chat to save space */
}

/* 1. Target the main page scrollbar */
html::-webkit-scrollbar {
    width: 8px; /* Slightly wider for the main page */
}

/* 2. Target all scrollable elements (like the chat or DM list) */
*::-webkit-scrollbar {
    width: 6px;
}

/* The background track */
*::-webkit-scrollbar-track, 
html::-webkit-scrollbar-track {
    background: transparent;
}

/* The draggable handle */
*::-webkit-scrollbar-thumb,
html::-webkit-scrollbar-thumb {
    background: var(--surface-strong);
    border-radius: 10px;
    border: 2px solid transparent; /* Creates a "floating" effect */
    background-clip: padding-box;
}

/* Hover state: Uses your accent color */
*::-webkit-scrollbar-thumb:hover,
html::-webkit-scrollbar-thumb:hover {
    background: var(--accent-soft);
    background-clip: padding-box;
}

/* Firefox Support (standard properties) */
* {
    scrollbar-width: thin;
    scrollbar-color: var(--surface-strong) transparent;
}
